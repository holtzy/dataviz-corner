import Head from "next/head";
import { blogs } from "data/blogs";
import { PostOverview } from "@/components/PostOverview";
import { Post } from "@/Utils/types";

type ComponentProps = {
  posts: Post[];
};

export default function Home(props: ComponentProps) {
  const allBlogs = blogs.map((blog, i) => {
    return <p key={i}>{blog.title}</p>;
  });

  const posts = props.posts;

  const allPosts = posts.map((post, i) => {
    return (
      <div key={i} className="">
        <PostOverview post={post} />
      </div>
    );
  });

  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <HeaderSection />

      <main>
        <div className="wrapper">
          <div className="flex flex-row w-full">
            <div className="w-3/4">{allPosts}</div>
            <div className="w-1/4 ">
              <p>Topics</p>
            </div>
          </div>
        </div>
      </main>

      <Contact />
    </>
  );
}

// Load all the posts stored in a JSON file
import fsPromises from "fs/promises";
import path from "path";
import { HeaderSection } from "@/components/HeaderSection";
import Contact from "@/components/Contact";
export async function getStaticProps() {
  const filePath = path.join(process.cwd(), "data/data.json");
  const jsonData = await fsPromises.readFile(filePath);
  const posts = JSON.parse(jsonData);

  return {
    props: {
      posts,
    },
  };
}
